<!doctype html> <html><head>
  <meta charset=utf-8>
  <meta name=viewport content="width=device-width, initial-scale=1">
  <title> Java Incremental Compile - drcicero</title>
  <link rel="shortcut icon" href="https://drcicero.github.io/avatar.png">
  <link rel="alternate" type="application/atom+xml" href="https://drcicero.github.io/feed.atom" title="Atom Feed">

  <style>
/* important styles here */
body {max-width:35em; min-height:100vh; margin:auto;
  font:16px/1.5 "Roboto","Helvetica Neue",Helvetica,sans-serif}
#header {text-align:center; animation:fromup 1s}
/*@keyframes fromup { 0% {transform:translateY(-5px); opacity:.5} to {} }*/
#header > a:before {content:""; display:inline-block;
  image-rendering: -moz-crisp-edges; image-rendering: pixelated;
  background-image: url(/avatar.png); width:48px; height:48px; transform:scale(1.8); margin:1em}

#menu {margin:auto; padding:0}
#menu > li {display:inline}
#menu a {display:inline-block; padding:.5em}
  </style>
  <link rel=stylesheet async href="https://drcicero.github.io/style.css">

</head><body>
  <header id=header>
    <a href=https://drcicero.github.io/><h1>DrCicero</h1><span>Thoughts on Computer Science</span></a>
<ul id="menu"><li><a href=https://drcicero.github.io/>Home</a></li>
  <li><a href=https://drcicero.github.io/posts/>Posts</a></li>
  <li><a href=https://drcicero.github.io/games/>Games</a></li>
  <li><a href=https://drcicero.github.io/music.html>Music</a></li>
  <li><a href=https://drcicero.github.io/feed.atom>Feed</a></li></ul>
  </header>

  <h1> Java Incremental Compile</h1>
  <p>
Compared to developing in python or lua, java programms seem pretty slow to compile and start. During programming one is often focues on a single tasked, changing only parts of a single file, so common optimization is 'incremental compilation', eg. only compiling the recently modified files.</p>

<p>I wrote a script that does a simplified model of incremental compilation. It recursivly compiles all '*.java' files in 'src/' that have been modified since the the last error-less compile. On a successfull compile an empty 'SUCCESS' file is touched to save the time of the last success as a basis for the next compilation.</p>

<p><pre><code language=shell>
#! /usr/bin/env sh

CP=.:bin

mkdir -p bin
FILES=$(find src -type f \
  $([ -f SUCCESS ] && echo "-newer SUCCESS" || echo) \
  -name "*.java")

for FILE in $FILES; do
  echo "*" "$FILE"
done

([ -z "$FILES" ] && echo || javac -d bin -cp "$CP" $FILES) &&
  touch SUCCESS
</code></pre></p>

<p><b>NOTE:</b> If you copy files into the folder, the 'recently modified' heuristic probably does not include your copied files from an older date. In that case you should delete the 'SUCCESS' file to make the script compile everything again.</p>

<p>As an added bonus, you can then either run the main file or a testsuite. On ubuntu junit4 is placed at /usr/share/java/junit4.jar, so i included that in my classpath. To run the junit4 from the console i used the 'org.junit.runner.JUnitCore' module.</p>

<p><pre><code>
#! /usr/bin/env sh

CLASSNAME=main.AllTests
CP=.:bin:/usr/share/java/junit4.jar

mkdir -p bin
FILES=$(find src -type f \
  $([ -f SUCCESS ] && echo "-newer SUCCESS" || echo) \
  -name "*.java")

for FILE in $FILES; do
  echo "*" "$FILE"
done

([ -z "$FILES" ] && echo || javac -d bin -cp "$CP" $FILES) &&
  touch SUCCESS &&
  echo STARTING &&
  java -cp "$CP" org.junit.runner.JUnitCore "$CLASSNAME"
</code></pre></p>

<p>Out of personal preference, i like to play friendly chime on completing a succesfull testsuite. In this case i used mplayer and added the following line to the end.</p>

<p><pre><code>
&& (mplayer /home/drcicero/Musik/Sounds/tadadi.mp3 > /dev/null 2>&1)
</code></pre></p>

<p>Happy Coding!
</p>

 <p><a class=footer-return-link href=/posts>more articles by drcicero</a></p></div>

  <small>Last updated: <date date=2017-10-17T15:39:09Z>17 Oct 2017</date></small>
  <script async>
(function () {"use strict";
  var mus = new Audio();

  function toggle(e) {
    if (mus.getAttribute("src") !== this.href) {
      var musics = document.getElementsByClassName("playing");
      for (var i=0; i<musics.length; i++) musics[i].classList.remove("playing");
      mus.src = this.href;
      mus.play(); this.classList.add("playing");

    } else if (mus.paused || mus.ended) {mus.play(); this.classList.add("playing");}
    else {mus.pause(); this.classList.remove("playing");}

    return false;
  }

  var musics = document.getElementsByClassName("music-link");
  for (var i=0; i<musics.length; i++)
    musics[i].onclick = toggle;
})();
  </script>
</body></html>
